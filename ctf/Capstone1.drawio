<mxfile host="app.diagrams.net" modified="2022-02-25T14:48:03.818Z" agent="5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36" etag="OZRvMHwKCV9RGYyQ0SE0" version="16.6.2" type="github">
  <diagram id="ZfgTW8RmMzK-_vYFPty-" name="Page-1">
    <mxGraphModel dx="1748" dy="481" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="850" pageHeight="1100" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="hog6Gc4PmT9u0CKpANyL-1" value="internet-host&lt;br&gt;Ext: 10.50.21.246&lt;br&gt;Int: 10.10.0.40" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#dae8fc;strokeColor=#6c8ebf;" vertex="1" parent="1">
          <mxGeometry y="745" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="hog6Gc4PmT9u0CKpANyL-2" target="hog6Gc4PmT9u0CKpANyL-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="hog6Gc4PmT9u0CKpANyL-2" target="hog6Gc4PmT9u0CKpANyL-14">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="hog6Gc4PmT9u0CKpANyL-2" target="hog6Gc4PmT9u0CKpANyL-15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-19" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=-0.005;entryY=0.573;entryDx=0;entryDy=0;entryPerimeter=0;" edge="1" parent="1" source="hog6Gc4PmT9u0CKpANyL-2" target="hog6Gc4PmT9u0CKpANyL-16">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-42" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1.094;exitDx=0;exitDy=0;entryX=0.5;entryY=0;entryDx=0;entryDy=0;fontSize=12;fontColor=#000000;exitPerimeter=0;" edge="1" parent="1" source="hog6Gc4PmT9u0CKpANyL-2" target="hog6Gc4PmT9u0CKpANyL-41">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="365" y="840" />
              <mxPoint x="365" y="1140" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-55" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;fontSize=8;fontColor=#000000;" edge="1" parent="1" source="hog6Gc4PmT9u0CKpANyL-2" target="hog6Gc4PmT9u0CKpANyL-20">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-2" value="capstone-01&lt;br&gt;Ext: 10.50.24.228&lt;br&gt;&lt;br&gt;MAC:&amp;nbsp;fa:16:3e:87:2e:49&lt;br&gt;eth0: 10.1.1.30/25, bc: .127&lt;br&gt;Lo: 127.0.0.1/8&lt;br&gt;Open Ports: 22, 80, (68, 123)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="275" y="720" width="180" height="110" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-37" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=12;fontColor=#000000;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" edge="1" parent="1" source="hog6Gc4PmT9u0CKpANyL-4" target="hog6Gc4PmT9u0CKpANyL-36">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="970" y="840" as="targetPoint" />
            <Array as="points">
              <mxPoint x="670" y="700" />
              <mxPoint x="670" y="815" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-4" value="capstone-04&lt;br&gt;&lt;br&gt;MAC:&amp;nbsp;fa:16:3e:b0:d7:01&lt;br&gt;eth0:10.1.1.33, bc: .127&lt;br&gt;Open Ports: 21, 23, 80&lt;br&gt;&lt;br&gt;eth1:1.1.1.1/29, bc: .7&lt;br&gt;Open Ports: 21, 23, 68, 80, 123&amp;nbsp;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="500" y="630" width="160" height="140" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-9" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;endArrow=none;" edge="1" parent="1" source="hog6Gc4PmT9u0CKpANyL-1" target="hog6Gc4PmT9u0CKpANyL-2">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="120" y="775" as="sourcePoint" />
            <mxPoint x="230" y="775" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-13" value="?&lt;br&gt;Ext: ?&lt;br&gt;&lt;br&gt;MAC:&amp;nbsp;fa:16:3e:b0:d7:01&lt;br&gt;eth?:?, bc: ?&lt;br&gt;Open Ports:&amp;nbsp;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="-120" y="860" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-14" value="capstone-02&lt;br&gt;&lt;br&gt;MAC: fa:16:3e:07:4f:f2&lt;br&gt;eth0:10.1.1.11, bc: .127&lt;br&gt;Open Ports: 21, 23, 80, 123 1918" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="500" y="370" width="160" height="125" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-15" value="?&lt;br&gt;Ext: ?&lt;br&gt;MAC: fa:16:3e:03:85:7d&lt;br&gt;&lt;br&gt;eth0:10.1.1.125, bc: .127&lt;br&gt;Lo: 127.0.0.1/8&lt;br&gt;Open Ports: ()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="500" y="840" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-16" value="?&lt;br&gt;Ext: ?&lt;br&gt;&lt;br&gt;MAC:&amp;nbsp;fa:16:3e:73:4e:16&lt;br&gt;eth0:10.1.1.126, bc: .127&lt;br&gt;Open Ports: ()" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="500" y="970" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-20" value="capstone-03?&lt;br&gt;&lt;br&gt;MAC:&amp;nbsp;&lt;br&gt;eth0:10.1.1.25, bc: .127&lt;br&gt;Open Ports: 21, 4869" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="500" y="510" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-21" value="Hint 2a: There is a webservice running on the port that &lt;br style=&quot;font-size: 10px&quot;&gt;corresponds with the RFC that governs private IP &lt;br&gt;addressing -&amp;gt; &lt;font color=&quot;#ff0000&quot;&gt;1918&amp;nbsp;&lt;/font&gt;(wget -r http://10.1.1.11:1918)&lt;br&gt;&lt;b&gt;Net Fundamentals Web Server&lt;/b&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontStyle=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="670" y="397" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-22" value="Hint 2b: There is a PCAP saved in the share folder of &lt;br&gt;this machine that you should look at (proxychains t&lt;br&gt;elnet 10.1.1.11)" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontStyle=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="670" y="455" width="250" height="40" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-23" value="Hint 3a: There is a webservice running on the port that &lt;br&gt;corresponds with&amp;nbsp;the RFC that governs IPv4 Header &lt;br&gt;Structure -&amp;gt; &lt;font color=&quot;#ff0000&quot;&gt;791 &lt;/font&gt;(wget -r http://10.1.1.25:791)&lt;b&gt;&lt;br&gt;Packet Crafting and Socket Programming&lt;/b&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontStyle=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="670" y="503" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-24" value="Hint 3b: There is a listening TCP port on this system &lt;br&gt;waiting for your connections build a python 3 TCP stream &lt;br&gt;sender and send it through your tunnel to say Hi. Send &lt;br&gt;message as bytes-like object and&amp;nbsp;decode response to/from &lt;br&gt;UTF-8 to get flag&amp;nbsp;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontStyle=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="670" y="554" width="280" height="70" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-25" value="Hint 4a: There is another Box (Capstone-05) on a different network (that&lt;br&gt;only this system can see) try to attack this box on one of the port(s)&amp;nbsp;&lt;br&gt;associated with the W32/Blaster Worm. Find out what message it&lt;br&gt;is trying to send -&amp;gt;&amp;nbsp;&lt;font color=&quot;#ff0000&quot;&gt;135T/U (69U, 136U, 137U, 138U, 445T, 593T, 4444T)&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontStyle=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="670" y="635" width="340" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-26" value="Hint 4b: RIPv2 seems to be running on the 10.1.1.0/25 network. Try to filter&lt;br&gt;it out. Find out what networks its advertising in its updates. What you find&lt;br&gt;will be the IP address of the next enviornment pivot to access from your&amp;nbsp;&lt;br&gt;INTERNET_HOST. Since you are not able to use wireshar,k I would &lt;br&gt;suggest to copy and paste the hexdump to another packet decoder -&amp;gt; &lt;font color=&quot;#ff0000&quot;&gt;520&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontStyle=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="670" y="685" width="350" height="70" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-27" value="Hint 1a: This system seems to be a pivot for&lt;br&gt;the Network Fundamentals and Programming&lt;br&gt;sections" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontStyle=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="230" y="680" width="220" height="40" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-30" value="&lt;font color=&quot;#000000&quot; style=&quot;font-size: 7px&quot;&gt;Q1:&amp;nbsp; APIPA 169.254/16 range RFC -&amp;gt;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px&quot;&gt;&amp;nbsp;3927 -&amp;gt; MzkyNwo=&lt;br style=&quot;font-size: 7px&quot;&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 7px&quot;&gt;Q2:&amp;nbsp; Ipv6 SLAAC multicast addr for solicitation -&amp;gt;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px&quot;&gt;&amp;nbsp;FF02::2 -&amp;gt;&amp;nbsp;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px&quot;&gt;RkYwMjo6Mgo=&lt;br style=&quot;font-size: 7px&quot;&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 7px&quot;&gt;Q3:&amp;nbsp; ARP type for MITM -&amp;gt;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px&quot;&gt;&amp;nbsp;REPLY -&amp;gt;&amp;nbsp;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px&quot;&gt;UkVQTFkK&lt;br style=&quot;font-size: 7px&quot;&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 7px&quot;&gt;Q4: attack frame with 0x8100 in it -&amp;gt;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px&quot;&gt;&amp;nbsp;VLAN HOPPING -&amp;gt;&amp;nbsp;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px&quot;&gt;VkxBTiBIT1BQSU5HCg==&lt;br style=&quot;font-size: 7px&quot;&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 7px&quot;&gt;Q5:&amp;nbsp; 5000b packet, MTU 1500, header len 7, frag offset? &lt;br style=&quot;font-size: 7px&quot;&gt;(1500 - (7*32 bits)/4)/8 -&amp;gt;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px&quot;&gt;&amp;nbsp;184 -&amp;gt;&amp;nbsp;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px&quot;&gt;MTg0Cg==&lt;br style=&quot;font-size: 7px&quot;&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=7;fontColor=#FF0000;" vertex="1" parent="1">
          <mxGeometry x="930" y="395" width="280" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-31" value="&lt;font color=&quot;#000000&quot; style=&quot;font-size: 7px&quot;&gt;Q1:&amp;nbsp;&lt;span style=&quot;font-size: 7px&quot;&gt;tcpdump -r capstone-bpf.pcap &quot;ip[1]&amp;amp;0xFC==0x68 and dst host&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 7px&quot;&gt;10.0.0.103&quot; | wc -l&lt;/span&gt;&amp;nbsp;-&amp;gt;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px&quot;&gt;&amp;nbsp;108 -&amp;gt; MTA4Cg==&lt;br style=&quot;font-size: 7px&quot;&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 7px&quot;&gt;Q2: tcpdump -r capstone-bpf.pcap &quot;ip[6]&amp;amp;0x20=0x20 || ip[6:2]&amp;amp;0x1FFF&amp;gt;0&quot; | wc -l&amp;nbsp;-&amp;gt;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px&quot;&gt;&amp;nbsp;2729 -&amp;gt;&amp;nbsp;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px&quot;&gt;MjcyOQo=&lt;br style=&quot;font-size: 7px&quot;&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 7px&quot;&gt;Q3:&amp;nbsp;&lt;span style=&quot;font-size: 7px&quot;&gt;tcpdump -r capstone-bpf.pcap &quot;ip[6]&amp;amp;0x40=0x40 &amp;amp;&amp;amp; tcp[13]=0x&amp;nbsp;&lt;/span&gt;&lt;span style=&quot;font-size: 7px&quot;&gt;05&quot; | wc -l&amp;nbsp;&lt;/span&gt;-&amp;gt;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px&quot;&gt;&amp;nbsp;109 -&amp;gt;&amp;nbsp;&amp;nbsp;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px&quot;&gt;MTA5Cg==&lt;br style=&quot;font-size: 7px&quot;&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 7px&quot;&gt;Q4:&amp;nbsp;&lt;span style=&quot;font-size: 7px&quot;&gt;tcpdump -r capstone-bpf.pcap &quot;dst host 10.0.0.104 &amp;amp;&amp;amp; tcp[13&lt;/span&gt;&lt;span style=&quot;font-size: 7px&quot;&gt;]&amp;amp;0x01=0x01&quot; | wc -l&lt;/span&gt;-&amp;gt;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px&quot;&gt;&amp;nbsp;18 -&amp;gt;&amp;nbsp;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px&quot;&gt;MTgK&lt;br style=&quot;font-size: 7px&quot;&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=7;fontColor=#FF0000;" vertex="1" parent="1">
          <mxGeometry x="930" y="455" width="350" height="40" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-34" value="&lt;font color=&quot;#000000&quot; style=&quot;font-size: 7px;&quot;&gt;Q1:&amp;nbsp; raw sockets in __ space -&amp;gt;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px;&quot;&gt;&amp;nbsp;KERNEL -&amp;gt; S0VSTkVMCg==&lt;br style=&quot;font-size: 7px;&quot;&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 7px;&quot;&gt;Q2:&amp;nbsp; python module for hex conversion -&amp;gt;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px;&quot;&gt;&amp;nbsp;binascii -&amp;gt;&amp;nbsp;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px;&quot;&gt;YmluYXNjaWkK&lt;br style=&quot;font-size: 7px;&quot;&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 7px;&quot;&gt;Q3:&amp;nbsp; packing IP4 raw header -&amp;gt;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px;&quot;&gt;&amp;nbsp;BBHHHBBH4s4s -&amp;gt;&amp;nbsp;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px;&quot;&gt;QkJISEhCQkg0czRzCg==&lt;br style=&quot;font-size: 7px;&quot;&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 7px;&quot;&gt;Q4: default encoding of data sent over network-&amp;gt;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px;&quot;&gt;&amp;nbsp;UTF-8 -&amp;gt;&amp;nbsp;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px;&quot;&gt;VVRGLTgK&lt;br style=&quot;font-size: 7px;&quot;&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 7px;&quot;&gt;Q5:&amp;nbsp; tcp header built for checksum calc&amp;nbsp;-&amp;gt;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px;&quot;&gt;&amp;nbsp;PSEUDO -&amp;gt;&amp;nbsp;&lt;/font&gt;&lt;font color=&quot;#009900&quot; style=&quot;font-size: 7px;&quot;&gt;UFNFVURPCg==&lt;br style=&quot;font-size: 7px;&quot;&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=7;fontColor=#FF0000;" vertex="1" parent="1">
          <mxGeometry x="930" y="505" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-36" value="capstone-05&lt;br&gt;&lt;br&gt;MAC:&amp;nbsp;fa:16:3e:11:3f:3b&lt;br&gt;eth0:1.1.1.2, bc: .7&lt;br&gt;Open Ports:&amp;nbsp;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="1000" y="755" width="160" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-38" value="&lt;font&gt;&lt;font color=&quot;#000000&quot; style=&quot;font-size: 7px&quot;&gt;Telnet into box and run&lt;br&gt;&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;tcpdump -i eth1 -A port 69&lt;/font&gt;&lt;br&gt;&amp;nbsp;&lt;font color=&quot;#009900&quot;&gt;&quot;I just want to say LOVE YOU SAN&quot; -&amp;gt;&lt;br&gt;SSBqdXN0IHdhbnQgdG8gc2F5IExPVkUgWU9VIFNBTgo=&amp;nbsp;&lt;/font&gt;&amp;nbsp;&lt;br style=&quot;font-size: 7px&quot;&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=7;fontColor=#FF0000;" vertex="1" parent="1">
          <mxGeometry x="1020" y="635" width="200" height="40" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-40" value="&lt;font&gt;&lt;font color=&quot;#000000&quot;&gt;tcpdump -i eth0 -vA port 520&lt;br&gt;new network:&amp;nbsp;&lt;/font&gt;&lt;font color=&quot;#009900&quot;&gt;10.50.27.11&lt;/font&gt;&lt;font color=&quot;#000000&quot;&gt;/32&lt;br&gt;nmap 10.50.27.11, wget for hint 6a&lt;/font&gt;&lt;br style=&quot;font-size: 7px&quot;&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=7;fontColor=#FF0000;" vertex="1" parent="1">
          <mxGeometry x="1020" y="705" width="120" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-50" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0.5;exitY=1;exitDx=0;exitDy=0;fontSize=8;fontColor=#000000;" edge="1" parent="1" source="hog6Gc4PmT9u0CKpANyL-41" target="hog6Gc4PmT9u0CKpANyL-48">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-41" value="capstone-06&lt;br&gt;Ext: 10.50.27.11&lt;br&gt;&lt;br&gt;MAC:&amp;nbsp;fa:16:3e:00:01:a5&lt;br&gt;eth0:10.2.2.6/28:, bc: .15&lt;br&gt;Open Ports: 23, 80, 7777 (ssh)" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="285" y="1140" width="160" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-43" value="Hint 6a: SSH is running on a higher port although it only &lt;br&gt;seems to accept connections when it looks like its coming &lt;br&gt;from a Cisco Device&#39;s TTL. The flag for this system is the &lt;br&gt;ssh port number." style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontStyle=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="460" y="1175" width="270" height="50" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-44" value="&lt;div style=&quot;font-size: 8px&quot;&gt;&lt;span style=&quot;font-size: 8px&quot;&gt;Cisco devices have TTL 255,&lt;/span&gt;&lt;/div&gt;mangle tables make everything look like something else&lt;br style=&quot;font-size: 8px&quot;&gt;sudo iptables -t mangle -A POSTROUTING -j TTL --ttl-set 255&lt;br&gt;nmap 10.50.27.11 -p 7000-8000&lt;br&gt;&lt;font color=&quot;#009900&quot;&gt;7777 -&amp;gt;&amp;nbsp;Nzc3Nwo=&lt;/font&gt;&lt;br&gt;ssh net3_student11@10.50.27.11 -p 7777" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=8;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="750" y="1160" width="230" height="70" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-46" value="Poke around:&amp;nbsp;ssh net3_student11@10.50.24.228 -D 9050 -NT" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=8;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="210" y="655" width="240" height="20" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-47" value="Poke around:&amp;nbsp;ssh net3_student11@10.50.27.11 &lt;br&gt;-D 9050 -p 7777 -NT" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=8;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="90" y="1160" width="180" height="30" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-51" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;fontSize=8;fontColor=#000000;" edge="1" parent="1" source="hog6Gc4PmT9u0CKpANyL-48" target="hog6Gc4PmT9u0CKpANyL-49">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-48" value="capstone-07&lt;br&gt;&lt;br&gt;MAC:&amp;nbsp;fa:16:3e:47:d5:26&lt;br&gt;eth0:10.2.2.7/28:, bc: .15&lt;br&gt;Open Ports: 23, 80&lt;br&gt;&lt;br&gt;MAC:&amp;nbsp;fa:16:3e:49:8f:53&lt;br&gt;eth1: 10.10.10.129/25, bc: .255&lt;br&gt;Open Ports: 37039, 42839, 23, 35393,33221, 31023, 80, 44817, 42673, 68,123, 2222" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="270" y="1340" width="190" height="180" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-49" value="capstone-?&lt;br&gt;&lt;br&gt;MAC:&amp;nbsp;fa:16:3e:89:ad:06&lt;br&gt;eth0:10.2.2.14/28:, bc: .15&lt;br&gt;Open Ports:&amp;nbsp;" style="rounded=1;whiteSpace=wrap;html=1;fillColor=#fff2cc;strokeColor=#d6b656;" vertex="1" parent="1">
          <mxGeometry x="515" y="1370" width="160" height="120" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-52" value="Hint 7a: SSH is running on a higher port but is not accessible&lt;br&gt;from the outside. It also seems to use different credentials&amp;nbsp;&lt;br&gt;than what the other systems use. How can we intercept these&lt;br&gt;credentials? Maybe another system has a tool that can help&lt;br&gt;us. The flag for this system is the password you find converted&lt;br&gt;to base64. credentials will be exactly what you find" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontStyle=2;fontSize=10;" vertex="1" parent="1">
          <mxGeometry x="-10" y="1360" width="290" height="80" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-53" value="From capstone 6, look for logins over tcp on telnet&lt;br&gt;tcpdump src host 10.2.2.7 and tcp port 23 -XX&lt;br&gt;&lt;font color=&quot;#009900&quot;&gt;Netflix and Chill -&amp;gt;&amp;nbsp;TmV0ZmxpeCBhbmQgQ2hpbGwK&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=8;fontColor=#000000;" vertex="1" parent="1">
          <mxGeometry x="-10" y="1440" width="210" height="40" as="geometry" />
        </mxCell>
        <mxCell id="hog6Gc4PmT9u0CKpANyL-54" value="&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;Make brand new tunnel system (go to 6 directly and tunnel because&amp;nbsp;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;no telnet permission on 6) to telnet into 7&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;all from IH terminals:&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;b&gt;IH1$&amp;nbsp;&lt;/b&gt;ssh net3_student11@10.50.27.11 -p 7777 -L 31101:localhost:777&lt;/font&gt;&lt;span style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;7 -NT&lt;/span&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;b&gt;IH2$:&amp;nbsp;&lt;/b&gt;ssh net3_student11@localhost -p 31101 -L 31102:10.2.2.7:23 -NT&lt;/font&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;b&gt;07$&amp;nbsp;&lt;/b&gt;telnet localhost 31102&lt;br&gt;&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;&lt;b&gt;07$&amp;nbsp;&lt;/b&gt;ss -antl&lt;/font&gt;&lt;/div&gt;&lt;div&gt;&lt;font color=&quot;#000000&quot;&gt;We have to reverse tunnel from here because ssh is is closed from the outside&lt;/font&gt;&lt;/div&gt;&lt;b style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;07$&amp;nbsp;&lt;/b&gt;&lt;span style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;ssh net3_student11@10.2.2.6 -p 7777 -R 31103:localhost:2222 -NT&lt;br&gt;&lt;/span&gt;&lt;b style=&quot;color: rgb(0 , 0 , 0)&quot;&gt;IH3$&amp;nbsp;&lt;/b&gt;&lt;font color=&quot;#000000&quot;&gt;ssh net3_student11@localhost -p 31101 -L 31104:localhost:31103 -NT&lt;br&gt;&lt;b&gt;IH4$ &lt;/b&gt;ssh net3_student11@localhost -p 31104 -D 9050 -NT&lt;br&gt;&lt;b&gt;IH5$&lt;/b&gt; proxychains ./scan.sh (10.10.10, 128-254, 21-23 80)&lt;br&gt;&lt;/font&gt;" style="text;html=1;align=left;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;fontSize=8;fontColor=#009900;" vertex="1" parent="1">
          <mxGeometry x="-10" y="1480" width="290" height="130" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
